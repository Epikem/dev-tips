# log 2022-03-26

--------------------------

- [blog](#blog)
- [arb](#arb)
- [tags](#tags)

## blog

## arb

file db 설계
키 이름 전체를 이용해서 path로 각 테이블마다 파일 생성.

계속 누적되도록 한다면?

특정 키에 대해 read/write만 할 수 있으면 된 것 아닌가.
write시 새 row 추가.
delete시 삭제 mark된 row 추가.
log 자체를 db로 쓰는건?

여러 속성이나 관계, 쿼리를 지원하긴 어차피 어렵다.

음.. 생각해보니 str하나로는 category까지 포함해서 나타내기 어렵다.
일단 가장 간단하게 하는 수준으로 해보자.

json과 같은 정보를 추가할텐데, 행별로 정보를 나타내려면..?

일단 생각한 형식. 을 테스트로.

생각보다 파일의 마지막 라인만 읽는게 어려운가 보다.

cqrs같은 방식을 적용하고 싶지만, 그러기엔 시간이 너무 들 듯하다.
그렇게 하려면 어떤 키에 대해 history + current + pointer를 관리해야 한다.

그래서 일단 현재 정보만 저장하기로 했다.
근데 그러려면 우선 파일을 읽기쓰기로 열어야 하는데, 그러면 파일을 덮어버린다.
그럼 먼저 존재하면 읽기부터 하고, 닫은 다음 다시 만들어야 할 듯하다.

애초에 멀티스레드/프로세스도 아닌데 그럴 필욘 없다만, 읽기/쓰기가 많아지면 느려질수도..

어쨌든, 파일을 쓸 때마다 닫고 다시 할 필요는 없게 하려면, 쓸 때마다 위치 0으로 옮기고,그러면 된다

w로도 읽기 가능하면 좋은데, 그건 안되는 모양이다.

read:
- 닫혀있으면 연다
- 내용 로드한다
- 닫는다
- 쓰기로 연다

write:
- 닫혀있으면 연다
- 쓴다

## tags
- blog
- arb
- project


--------------------------


 